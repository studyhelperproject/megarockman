# AGENTS.md: Coding Agents Guide for Rockman2-like Browser Game Project

## 1. Project Overview & Purpose
- **Primary Goal:** Create a faithful browser-based clone of Rockman 2 (Mega Man 2) using Phaser.js for 2D game logic and rendering. Use Gemini AI for full automation of asset creation (sprites, backgrounds, UI) and possibly for game code generation.
- **Business Domain:** Game Development, AI-assisted Automated Game Production

## 2. Core Technologies & Stack
- **Languages:** JavaScript, TypeScript (for core game logic and automation scripting)
- **Frameworks & Libraries:** Phaser.js (HTML5 2D game engine), Node.js + npm (development environment), Gemini API (AI-assisted image and code generation)
- **Asset Sources:** OpenGameArt, Kenney, itch.io (free 8-bit style assets), Gemini API for missing assets
- **Platforms:** Web browsers (desktop and mobile compatible)
- **Package Managers:** npm, yarn, or pnpm (suggest npm for simplicity)

## 3. Architectural Patterns
- **Overall Architecture:** Component-based 2D game engine architecture using Phaser's Scene and GameObject system. Modular structure separating game logic, asset loading, UI, and AI generation tasks.

- **Directory Structure Philosophy:**
  - `/src`: Game source code and logic scripts
  - `/assets`: Static assets (images, sounds), some autogenerated by Gemini
  - `/scripts`: AI generation orchestration and automation scripts for Gemini API usage
  - `/build`: Compiled/transpiled outputs ready for deployment
  - `/docs`: Documentation including this AGENTS.md and technical specs
  - `/scripts`: AI generation orchestration and automation scripts for Gemini API usage
    - `/scripts/tasks`: YAML files defining generation tasks for the AI agent.

## 4. Coding Conventions & Style Guide
- **Formatting:** Use standard JS/TS formatting (Prettier recommended). 2 spaces indent.
- **Naming Conventions:** camelCase for variables and functions, PascalCase for classes. Constants in UPPER_SNAKE_CASE.
- **API Design:** Object-oriented style with Phaser's Scene subclassing. Clear separation of input handling, game state, and rendering.
- **Extensibility:** Use Phaser's plugin system and custom components to enable adding new enemies, weapons, and stages without core changes.
- **Error Handling:** Use standard try/catch where needed; rely on Phaser's event system for runtime error reporting.

## 5. Key Files & Entrypoints
- `src/main.ts` or `src/main.js`: Game entry point, initializes Phaser game instance, loads main scene.
- `scripts/gemini-agent.ts`: Automation scripts handling Gemini API calls for asset and code generation.
- `src/scenes/StageSelectScene.ts`: Stage selection logic.
- `src/scenes/GameScene.ts`: Main gameplay logic.
- `src/assets/`: Holds static and generated assets.
- `package.json` / `tsconfig.json`: Project dependency and TypeScript configuration.

## 6. Development & Testing Workflow
- Use `npm install` to set up dependencies.
- Run development server via `npm run dev` (e.g. using Vite or Webpack Dev Server).
- Use automated scripts in `/scripts` to update assets via Gemini API (`node scripts/gemini-agent.ts`).
- Test gameplay both locally and on deployed environments (GitHub Pages, Vercel).
- Write unit tests for critical logic using Jest or similar.

## 7. Agent Instructions for Cooperation
- Handle asset generation with detailed prompts describing 8-bit style character sprites, backgrounds, UI elements.
- Automate repetitive tasks such as sprite animation setup, physics tuning, and AI enemy behavior generation.
- Generate code snippets aligned with Phaser.js patterns and project naming conventions.
- Report any ambiguity or missing information to human developers for clarification.
### 7.1. Asset Generation Prompts

When requesting assets, use the following template to provide clear instructions.

**Prompt Template:**
`Generate a [asset_type] for [purpose]. Style: 8-bit, [specific_style (e.g., NES color palette, Rockman 2-like)]. Details: [specific_details (e.g., 32x32 pixels, 4 frames of running animation, transparent background)]. Output format: [format (e.g., PNG sprite sheet)].`

**Example:**
`Generate a sprite sheet for the player's running animation. Style: 8-bit, Rockman 2-like, using the NES color palette. Details: 4 frames of animation on a single row, each frame 32x32 pixels, transparent background. Output format: PNG sprite sheet.`

### 7.2. Task Definition using YAML

For complex or repetitive tasks, define the request in a `.yml` file within the `/scripts/tasks` directory. The agent should parse these files to execute tasks.

**Example Task File (`/scripts/tasks/generate_enemy_assets.yml`):**
```yaml
- task: generate_asset
  asset_name: "Met" # メットール
  type: "sprite_sheet"
  description: "A common small enemy that hides under a helmet."
  specifications:
    style: "8-bit, Rockman 2"
    palette: "NES"
    output_path: "assets/sprites/enemies/met.png"
  animations:
    - name: "idle"
      frames: 2
      description: "Hiding under the helmet, slightly bobbing."
      size_per_frame: "24x24"
    - name: "attack"
      frames: 3
      description: "Lifts helmet and shoots a 3-way bullet."
      size_per_frame: "24x24"
## 8. Scope of AI Agent's Work

To ensure focus and prevent unintended changes, the agent should adhere to the following scope:

### In Scope (What to do ✅)
- Generate new assets (sprites, tilesets, backgrounds) and place them in the `/assets` directory.
- Create new game scenes or enemy logic files in the `/src` directory based on explicit instructions.
- Write or modify automation scripts in the `/scripts` directory.
- Refactor code for readability or performance **when specifically asked to**.

### Out of Scope (What NOT to do ❌)
- Do not modify core configuration files like `package.json`, `tsconfig.json`, or `.github/workflows/*.yml` without explicit approval.
- Do not add or remove npm dependencies.
- Do not commit directly to the `main` branch. Always work on a feature branch.

## 9. Deployment
- **Platform:** The project is deployed to GitHub Pages.
- **Workflow:** Deployment is handled automatically by the workflow defined in `.github/workflows/deploy.yml`. This workflow builds the application and prepares it for deployment.
- **Repository Settings:** For the deployment to succeed, the repository's settings must be configured correctly.
  - Go to `Settings` > `Pages`.
  - Under `Build and deployment`, set the **Source** to **"GitHub Actions"**.
- **URL Structure:** The `vite.config.ts` is configured with `base: '/megarockman/'`.
- **Final URL:** The live application is accessible at `https://studyhelperproject.github.io/megarockman/`.
---
